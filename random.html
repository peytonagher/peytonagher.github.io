<!DOCTYPE html>
<html lang = "en_US">
    <head>
        <meta charset = "UTF-8">
        <meta name = "description" content = "random">
        <title>check back later!</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="styles.css"/>
    </head>
    <header>
        <nav>
            <ul>
                <li>
                    <a href="index.html" style="text-decoration:none">home</a>
                </li>
                <li>
                    <a href="resume.html" style="text-decoration:none">resume</a>
                </li>
                <li>
                    <a href="random.html" style="text-decoration:none">random</a>
                </li>
            </ul>
        </nav>
    </header>
    <body>
        <canvas id="gameCanvas" width="400" height="400"></canvas>
        <style>
            #gameCanvas {
                position: relative;
                top: 50%;
                bottom: 50%;
                left: 50%;
                right: 50%;
                transform: translate(-50%, -50%);
            }
        </style>
    <script> 
        // snake game in javascript

        document.addEventListener("DOMContentLoaded", 
            function () {
                alert("snake loaded!");
                pTag = document.querySelector("div");
                newVal = document.createElement("p");
                newVal.innerHTML = '';
                pTag.appendChild(newVal);
            }
        );

        const boardBorder = "#333333";
        const boardBackground = "#333333";
        const snakeColor = "cyan";
        const snakeBorder = "blue";

        let snake = [{x: 200, y: 200}, 
                    {x: 190, y: 200}, 
                    {x: 180, y: 200}, 
                    {x: 170, y: 200}, 
                    {x: 160, y: 200}];

        let dx = 10;    // horizontal velocity
        let dy = 0;     // vertical velocity
        let food_x;
        let food_y;
        let changingDirection = false;
        var board = document.getElementById("gameCanvas");
        var boardDimensions = gameCanvas.getContext("2d");

        main();
        foodTime();
        // add false as 3rd arg here?
        document.addEventListener("keydown", changeDirection) 

        function main() {
            if (gameEnd()) return;
            changingDirection = false;
            setTimeout(function onTick() { 
                clearGameCanvas();
                makeBeesechurgers();
                moveSnake();
                drawBigSnake();
                main();
            }, 100)
        }

        function clearGameCanvas() {
            boardDimensions.fillStyle = boardBackground;
            boardDimensions.strokestyle = boardBorder;
            boardDimensions.fillRect(0, 0, board.width, board.height);
            boardDimensions.strokeRect(0, 0, board.width, board.height);
        }

        function makeBeesechurgers() {
            boardDimensions.fillStyle = "red";
            boardDimensions.strokestyle = "beige";
            boardDimensions.fillRect(food_x, food_y, 10, 10);
            boardDimensions.strokeRect(food_x, food_y, 10, 10);
        }

        function moveSnake() {
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};
            snake.unshift(head);
            const gotNomNoms = snake[0].x === food_x && snake[0].y === food_y;
            if (gotNomNoms) {
                foodTime();
            }
            else {
                snake.pop();
            }
        }

        function drawBigSnake() {
            snake.forEach(drawLittleSnake);
        }

        function drawLittleSnake(snakeChunk) {
            boardDimensions.fillStyle = 'lightblue';
            boardDimensions.strokestyle = "darkblue";
            boardDimensions.fillRect(snakeChunk.x, snakeChunk.y, 10, 10);
            boardDimensions.strokeRect(snakeChunk.x, snakeChunk.y, 10, 10);
        }

        function beesechurgers(min, max) {
            return Math.round((Math.random() * (max - min) + min) / 10) * 10;
        }

        function foodTime() {
            food_x = beesechurgers(0, board.width - 10);
            food_y = beesechurgers(0, board.height - 10);
            snake.forEach(function isSnakeHungy(part) {
                const isFull = part.x == food_x && part.y == food_y;
                if (isFull) {
                    foodTime();
                }});
        }

        function changeDirection(event) {
            const LEFT_KEY = 37;
            const RIGHT_KEY = 39;
            const UP_KEY = 38;
            const DOWN_KEY = 40;
            
            const keyPressed = event.keyCode;
            const goingUp = dy === -10;
            const goingDown = dy === 10;
            const goingRight = dx === 10;  
            const goingLeft = dx === -10;
            
            if (keyPressed === LEFT_KEY && !goingRight) {    
                dx = -10;
                dy = 0;  
            }

            if (keyPressed === UP_KEY && !goingDown) {    
                dx = 0;
                dy = -10;
            }

            if (keyPressed === RIGHT_KEY && !goingLeft) {    
                dx = 10;
                dy = 0;
            }

            if (keyPressed === DOWN_KEY && !goingUp) {    
                dx = 0;
                dy = 10;
            }
        }

        function gameEnd() {  
            for (let i = 4; i < snake.length; i++) {    
                const collided = snake[i].x === snake[0].x && snake[i].y === snake[0].y
                if (collided) {
                    return true
                }
            }
            const hitLeftWall = snake[0].x < 0;
            const hitRightWall = snake[0].x > board.width - 10;
            const hitToptWall = snake[0].y < 0;
            const hitBottomWall = snake[0].y > board.height - 10;
            return hitLeftWall || hitRightWall || hitToptWall || hitBottomWall
        }

    </script>
    </body>
    <!-- <img class="gif" src="media/hello-there-obi-wan.gif" alt="jif" style = "width:50%"> -->
    <footer>
        <div class="disclaimer">
            disclaimer: this website will be a work in progress until further notice.
        </div>
        <div class="social-media">
            <ul>
                <li>
                    <a href="https://www.linkedin.com/in/peyton-nagher-570044201/" target="_blank"><img  src = "media/linkedinlogo.png" style="width:100%"></a>
                </li>
                <li>
                    <a href="https://github.com/peytonagher" target="_blank"><img  src = "media/githublogo.png" style="width:100%"></a>
                </li>
            </ul>
        </div>
        <p class="datetime"><span id="datetime"></span></p>
        <script>
            var date =  new Date();
            document.getElementById("datetime").innerHTML = (("0" + (date.getMonth() + 1)).slice(-2)) + "." + 
            (("0" + date.getDate()).slice(-2)) + "." + (date.getFullYear());
        </script>
        <h4>est. 2021</h4>
        <br><br>
    </footer>
</html>